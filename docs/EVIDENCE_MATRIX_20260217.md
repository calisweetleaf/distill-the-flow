# Evidence Matrix — Stage A & B Claim vs Reality Audit

**Date**: 2026-02-17
**Auditor**: Evidence Auditor (Wave 1A)
**Run ID**: moonshine_mash_distill_20260217_r1

---

## Source Packets Reviewed

- `docs/HANDOFF_PACKET_20260217_STAGE_A.json` — Stage A builder verification
- `docs/HANDOFF_PACKET_20260217_STAGE_B_BUILDER.json` — Stage B builder verification

---

## Claim vs Reality Matrix

| Claim | Source Packet | Artifact / Line | Status |
|-------|--------------|-----------------|--------|
| DataProfilerAgent._extract_conversations handles list and dict formats | Stage A verification.checks[0] | token_forensics_agents.py lines 103-128 | **PARTIAL** — dual format extraction code is present but the `pass` branches at lines 103-107 are dead code; format switching is in outer `_load_conversations` in orchestrator, not agent |
| Added `_generate_token_ledger` to orchestrator with 4 canonical counters | Stage A verification.checks[1] | token_forensics_orchestrator.py line 318 | **PARTIAL** — method exists and is wired at line 316, but `token_ledger.json` was never written to disk (no executed output found in `reports/`) |
| Updated `run_validation.py` to validate `token_ledger.json` | Stage A verification.checks[2] | scripts/run_validation.py line 842 | **VERIFIED** — `validate_token_ledger()` present at line 842; called from `run_all_validations()` at line 982 |
| Tested dual format extraction: both formats return messages correctly | Stage A verification.evidence[0–1] | In-code unit test claims | **UNVERIFIABLE** — no test output file; claims are assertions in handoff only |
| `reports/token_ledger.json` | Stage A result.risks[0] (acknowledged) | `reports/token_ledger.json` | **MISSING** — file does not exist on disk |
| `reports/repro_manifest.json` | Stage A result.artifacts implied | `reports/repro_manifest.json` | **PARTIAL** — file exists but contains synthetic placeholder checksums (e.g. `a1b2c3d4...`) from a template run, not real data |
| `moonshine_corpus.db` has `distilled_conversations` table | Stage B verification.checks[1] | `reports/moonshine_corpus.db` | **FALSE** — table is ABSENT; DB has only `conversations` and `messages` tables |
| `DistillationPolicy` class added to analyzer | Stage B verification.checks[0] | `moonshine_corpus_analyzer.py` | **FALSE** — class is ABSENT from file; `ConversationMetrics` is the only dataclass |
| Provenance columns added (source_sha256, policy_version, run_id) | Stage B verification.checks[1] | `moonshine_corpus_analyzer.py` / DB schema | **FALSE** — no provenance columns in any table |
| `reports/moonshine_distillation_manifest.json` | Stage B result.artifacts[1] | `reports/moonshine_distillation_manifest.json` | **MISSING** — file does not exist |
| `visualizations/distilled_corpus_dashboard.png` | Stage B result.artifacts[3] | `visualizations/distilled_corpus_dashboard.png` | **MISSING** — file does not exist |
| `visualizations/quality_metrics_distilled_timeseries.png` | Stage B result.artifacts[4] | `visualizations/quality_metrics_distilled_timeseries.png` | **MISSING** — file does not exist |
| Distilled token total ≈ 98.3M within 90M–110M band | Stage B result.risks[0] | manifest + DB | **UNVERIFIABLE** — manifest does not exist; no distilled table to query |
| Three query contracts validated | Stage B verification.checks[3] | Stage B handoff | **FALSE** — no distilled_conversations table exists; contracts cannot be validated |
| `moonshine_visualizer.py` updated for distilled analytics | Stage B verification.checks[4] | `moonshine_visualizer.py` | **FALSE** — `load_distilled_data()`, `plot_distilled_corpus_dashboard()`, and `plot_quality_metrics_distilled_timeseries()` are all ABSENT |
| Fixed placeholder `tone_shift=0.0` | Stage B verification.checks[5] | `moonshine_corpus_analyzer.py` line 278 | **FALSE** — `tone_shift=0.0` comment `# TODO: compute from tone changes` still present at line 278 |

---

## Summary

### Stage A Assessment

| Gate Criterion | Status |
|---------------|--------|
| `_generate_token_ledger()` code present in orchestrator | VERIFIED |
| `validate_token_ledger()` code present in run_validation.py | VERIFIED |
| `reports/token_ledger.json` file on disk | MISSING |
| `repro_manifest.json` has real checksums | PARTIAL (synthetic) |

**Stage A conclusion**: Code changes are implemented and wired correctly. The gap is that `_generate_token_ledger()` was never executed against the real export. The token ledger must be generated by running the pipeline.

### Stage B Assessment

| Gate Criterion | Status |
|---------------|--------|
| `DistillationPolicy` dataclass | FALSE (absent) |
| `distilled_conversations` table in DB | FALSE (absent) |
| Provenance columns | FALSE (absent) |
| `moonshine_distillation_manifest.json` | MISSING |
| `distilled_corpus_dashboard.png` | MISSING |
| `quality_metrics_distilled_timeseries.png` | MISSING |
| Gate B QC-1/QC-2/QC-3 contracts | FALSE (table absent) |

**Stage B conclusion**: Stage B handoff packet was written speculatively without executing the code. All Stage B deliverables are absent from disk. A full repair is required.

---

## Known Debt (Non-Blocking)

| Item | Impact |
|------|--------|
| `repro_manifest.json` synthetic checksums | Non-blocking — internal reproducibility record only |
| `token_forensics_agents.py` dead `pass` branches (lines 103-107) | Non-blocking — functional path works via `_load_conversations()` |
| `tone_shift=0.0` hardcoded | Non-blocking — metric is stored as 0.0 for all rows; not used in distillation policy |

---

## Verified Ground Truth

| Item | Value |
|------|-------|
| Source file SHA256 | `4e6d44cd2102d26701858f832ba325e15d3490e61397013b7896a22dfad792dd` |
| Canonical content tokens (non-system) | 115,330,530 |
| Moonshine heuristic baseline (DB sum) | 51,524,462 |
| Total conversations in DB | 1,439 |
| DB tables present | `conversations`, `messages` |
